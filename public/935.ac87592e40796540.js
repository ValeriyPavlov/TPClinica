"use strict";(self.webpackChunkTPClinica=self.webpackChunkTPClinica||[]).push([[935,84],{8642:(S,f,i)=>{i.d(f,{u:()=>y});var _=i(5861),e=i(9468),l=i(5710),u=i(7615),d=i(6084),v=i(3251),O=i(6814),A=i(346);function D(r,m){if(1&r&&(e.TgZ(0,"div")(1,"h2",3),e._uU(2),e.qZA()()),2&r){const t=e.oxw();e.xp6(2),e.AsE("Historia Cl\xednica de ",t.selectedUser.lastName,", ",t.selectedUser.name,":")}}function P(r,m){if(1&r&&(e.TgZ(0,"option",10),e._uU(1),e.qZA()),2&r){const t=m.$implicit;e.s9C("value",t.userId),e.xp6(1),e.AsE("",t.lastName,", ",t.name,"")}}function T(r,m){if(1&r){const t=e.EpF();e.TgZ(0,"div")(1,"h2",3),e._uU(2,"Mi Historia Cl\xednica:"),e.qZA(),e.TgZ(3,"div",3)(4,"button",4),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.downloadMedicalRecord())}),e._uU(5,"Descargar "),e._UZ(6,"img",5),e.qZA()(),e.TgZ(7,"div",3)(8,"select",6)(9,"option",7),e._uU(10,"Seleccione una opcion..."),e.qZA(),e.TgZ(11,"option",8),e._uU(12,"TODOS"),e.qZA(),e.YNc(13,P,2,3,"option",9),e.qZA()()()}if(2&r){const t=e.oxw();e.xp6(13),e.Q6J("ngForOf",t.listOfUniqueSpecialist)}}function a(r,m){if(1&r&&(e.TgZ(0,"h5"),e._uU(1),e.qZA()),2&r){const t=m.$implicit;e.xp6(1),e.Oqu(t)}}function E(r,m){if(1&r&&(e.TgZ(0,"div",16)(1,"div",17),e._uU(2," Rese\xf1a: "),e.qZA(),e.TgZ(3,"div",18)(4,"p",23),e._uU(5),e.qZA()(),e.TgZ(6,"div",19),e._uU(7," Diagnostico: "),e.qZA(),e.TgZ(8,"div",18),e.YNc(9,a,2,1,"h5",24),e.qZA()()),2&r){const t=e.oxw().$implicit,n=e.oxw(3);e.xp6(5),e.Oqu(t.review),e.xp6(4),e.Q6J("ngForOf",n.getDiagnosis(t))}}function c(r,m){if(1&r&&(e.TgZ(0,"div",15)(1,"div",16)(2,"div",17),e._uU(3," Fecha y Hora: "),e.qZA(),e.TgZ(4,"div",18),e._uU(5),e.ALo(6,"hours"),e.ALo(7,"hours"),e.qZA(),e.TgZ(8,"div",19),e._uU(9," Especialista: "),e.qZA(),e.TgZ(10,"div"),e._UZ(11,"img",20),e._uU(12),e.qZA(),e.TgZ(13,"div",19),e._uU(14," Especialidad: "),e.qZA(),e.TgZ(15,"div"),e._UZ(16,"img",21),e._uU(17),e.qZA()(),e.YNc(18,E,10,2,"div",22),e.qZA()),2&r){const t=m.$implicit,n=e.oxw(3);e.xp6(5),e.lnq(" ",t.day.date," ",e.lcZ(6,9,t.day.timeStart)," - ",e.lcZ(7,11,t.day.timeEnd),"hs "),e.xp6(6),e.s9C("src",t.specialist.profilePhoto,e.LSH),e.xp6(1),e.AsE(" ",t.specialist.lastName,", ",t.specialist.name," "),e.xp6(4),e.s9C("src",n.getSpecialityPhoto(t.speciality),e.LSH),e.xp6(1),e.hij(" ",t.speciality," "),e.xp6(1),e.Q6J("ngIf",t)}}function o(r,m){if(1&r&&(e.TgZ(0,"div",13),e.YNc(1,c,19,13,"div",14),e.qZA()),2&r){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.myAppointments)}}function p(r,m){1&r&&(e.TgZ(0,"div")(1,"h3"),e._uU(2,"El paciente seleccionado aun no tiene Historial Clinico."),e.qZA()())}function g(r,m){if(1&r&&(e.TgZ(0,"div",11),e.YNc(1,o,2,1,"div",12),e.YNc(2,p,3,0,"div",1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.myAppointments.length>0),e.xp6(1),e.Q6J("ngIf",0==t.myAppointments.length)}}let y=(()=>{class r{constructor(t,n,s,h){this.aService=t,this.uService=n,this.sService=s,this.alertService=h,this.showTable=new e.vpe,this.myAppointments=[],this.listOfSpecialities=[],this.filteredAppointments=[],this.listOfUniqueSpecialist=[],this.listOfSpecialists=[],this.selectedSpecialistId="",this.setSpecialities(),this.aService.getAppointments()}ngOnChanges(){this.getMedicalRecord(this.selectedUser)}getMedicalRecord(t){null!=t&&(this.myAppointments=this.aService.appointments.filter(s=>s.patient.userId==t.userId&&"Realizado"==s.state),this.myAppointments=this.myAppointments.sort((s,h)=>h.day.date!==s.day.date?new Date(parseInt(s.day.date.substring(6)),parseInt(s.day.date.substring(3,5)),parseInt(s.day.date.substring(0,2)))>new Date(parseInt(h.day.date.substring(6)),parseInt(h.day.date.substring(3,5)),parseInt(h.day.date.substring(0,2)))?1:-1:parseFloat(s.day.timeStart)!=parseFloat(h.day.timeStart)?parseFloat(s.day.timeStart)>parseFloat(h.day.timeStart)?1:-1:0)),this.listOfSpecialists=[],this.listOfUniqueSpecialist=[],this.myAppointments.forEach(s=>{this.listOfSpecialists.includes(s.specialist.userId)||(this.listOfSpecialists.push(s.specialist.userId),this.listOfUniqueSpecialist.push(s.specialist))});const n=document.getElementById("specialist");n?.addEventListener("change",s=>{this.selectedSpecialistId=s.target.value})}return(){this.showTable.emit(!0)}setSpecialities(){var t=this;return(0,_.Z)(function*(){t.listOfSpecialities=yield t.sService.getAllSpecialities()})()}getSpecialityPhoto(t){let n;return this.listOfSpecialities?.forEach(s=>{s.description==t&&(n=s.image)}),n}getDiagnosis(t){let n=[];if(null!=t){let s=t.diagnosis;n.push(`Altura: ${s.height} cm`),n.push(`Peso: ${s.weight} kg`),n.push(`Temperatura: ${s.temperature} C\xb0`),n.push(`Presion: ${s.pressure} mmHg`),s.dynamicData?.forEach(h=>{n.push(`${h.key}: ${h.value}`)})}return n}downloadMedicalRecord(){""!=this.selectedSpecialistId?"all"==this.selectedSpecialistId?this.uService.createPdf(this.myAppointments,this.uService.userLogged):(this.filteredAppointments=this.myAppointments.filter(t=>t.specialist.userId==this.selectedSpecialistId),this.uService.createPdf(this.filteredAppointments,this.uService.userLogged)):this.alertService.showAlert({icon:"error",message:"Debe seleccionar una opcion para descargar",timer:2e3})}static#e=this.\u0275fac=function(n){return new(n||r)(e.Y36(l.H),e.Y36(u.K),e.Y36(d.d),e.Y36(v.c))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-history"]],inputs:{selectedUser:"selectedUser"},outputs:{showTable:"showTable"},features:[e.TTD],decls:4,vars:3,consts:[[1,"d-flex","flex-column","justify-content-center","align-items-center","m-3","p-3"],[4,"ngIf"],["class","w-75 m-5 p-2 card bg-beige",4,"ngIf"],[1,"d-flex","justify-content-center","align-items-center","m-1","p-1"],[1,"btn","boton","m-2","p-2",3,"click"],["src","../../../assets/img/pdf.png","alt","pdf",2,"height","60px","width","60px"],["name","specialist","id","specialist",1,"form-select"],["value","","disabled","","selected",""],["value","all"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"w-75","m-5","p-2","card","bg-beige"],["class","d-flex flex-column",4,"ngIf"],[1,"d-flex","flex-column"],["class","card m-1 p-1",4,"ngFor","ngForOf"],[1,"card","m-1","p-1"],[1,"d-flex","flex-row","m-1","p-1"],[1,"titles"],[2,"padding-left","20px"],[1,"titles","padL"],["alt","foto_especialista",2,"height","100px","width","100px",3,"src"],["alt","foto_especialidad",2,"height","100px","width","100px",3,"src"],["class","d-flex flex-row m-1 p-1",4,"ngIf"],[1,"texto-limitado"],[4,"ngFor","ngForOf"]],template:function(n,s){1&n&&(e.TgZ(0,"div",0),e.YNc(1,D,3,2,"div",1),e.YNc(2,T,14,1,"div",1),e.YNc(3,g,3,2,"div",2),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngIf","admin"==(null==s.uService.userLogged?null:s.uService.userLogged.userRole)&&null!=s.selectedUser),e.xp6(1),e.Q6J("ngIf","paciente"==(null==s.uService.userLogged?null:s.uService.userLogged.userRole)),e.xp6(1),e.Q6J("ngIf",null!=s.selectedUser))},dependencies:[O.sg,O.O5,A.X],styles:[".bg-beige[_ngcontent-%COMP%]{background-color:beige}.boton[_ngcontent-%COMP%]{border:2px solid black;background-color:#0ff}.boton[_ngcontent-%COMP%]:hover{background-color:#4e4ef1;color:#fff}.texto-limitado[_ngcontent-%COMP%]{overflow:visible;white-space:pre-wrap;text-overflow:clip;width:400px}.titles[_ngcontent-%COMP%]{font-weight:700;text-decoration:underline}.padL[_ngcontent-%COMP%]{padding-left:10%}"]})}return r})()},6710:(S,f,i)=>{i.d(f,{H:()=>u});var _=i(6814),e=i(103),l=i(9468);let u=(()=>{class d{static#e=this.\u0275fac=function(A){return new(A||d)};static#t=this.\u0275mod=l.oAB({type:d});static#i=this.\u0275inj=l.cJS({imports:[_.ez,e.D]})}return d})()},346:(S,f,i)=>{i.d(f,{X:()=>e});var _=i(9468);let e=(()=>{class l{transform(d,...v){return parseFloat(d)%1==0?`${d}:00`:`${Math.floor(d)}:30`}static#e=this.\u0275fac=function(v){return new(v||l)};static#t=this.\u0275pipe=_.Yjl({name:"hours",type:l,pure:!0})}return l})()},103:(S,f,i)=>{i.d(f,{D:()=>l});var _=i(6814),e=i(9468);let l=(()=>{class u{static#e=this.\u0275fac=function(O){return new(O||u)};static#t=this.\u0275mod=e.oAB({type:u});static#i=this.\u0275inj=e.cJS({imports:[_.ez]})}return u})()},5710:(S,f,i)=>{i.d(f,{H:()=>O});var _=i(5861),e=i(15),l=i(3182),u=i(9413),d=i(9468),v=i(3384);let O=(()=>{class P{constructor(a){this.firebaseStoreProvider=a,this.appointments=[]}getAllAppointments(){return this.firebaseStoreProvider.getCollection("turnos")}getAppointments(){var a=this;return(0,_.Z)(function*(){const E=(0,e.IO)((0,e.hJ)(D,"turnos"));(0,e.cf)(E,c=>(a.appointments=[],c.forEach(function(){var o=(0,_.Z)(function*(p){var g=p.data();a.appointments.push({...g})});return function(p){return o.apply(this,arguments)}}()),a.appointments))})()}saveAppointmentWithIdInStore(a,E){return this.firebaseStoreProvider.setDocWithId("turnos",a,JSON.parse(JSON.stringify(E)))}saveAppointmenInStore(a){const E=this.firebaseStoreProvider.createDoc("turnos");return a.id=E.id,this.firebaseStoreProvider.saveDoc(E,JSON.parse(JSON.stringify(a)))}static#e=this.\u0275fac=function(E){return new(E||P)(d.LFG(v.f))};static#t=this.\u0275prov=d.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"})}return P})();const A=(0,l.ZF)(u.N.firebaseConfig),D=(0,e.ad)(A)},6084:(S,f,i)=>{i.d(f,{d:()=>D});var _=i(5861),e=i(4036),l=i(15),u=i(3182),d=i(9413),v=i(9468),O=i(3384),A=i(388);let D=(()=>{class a{constructor(c,o){this.firebaseStoreProvider=c,this.firebaseStorageProvider=o,this.specialitys=[]}getAllSpecialities(){var c=this;return(0,_.Z)(function*(){let o=yield(0,e.z)(c.firebaseStoreProvider.getCollection("specialities"));return o=yield Promise.all(o.map(function(){var p=(0,_.Z)(function*(g){return{...g,image:yield c.getSpecialityPhoto(g)}});return function(g){return p.apply(this,arguments)}}())),o})()}getSpecialities(){var c=this;return(0,_.Z)(function*(){const o=(0,l.IO)((0,l.hJ)(T,"specialities"));(0,l.cf)(o,p=>(c.specialitys=[],p.forEach(function(){var g=(0,_.Z)(function*(y){var r=y.data();c.specialitys.push({...r,image:yield c.getSpecialityPhoto(r)})});return function(y){return g.apply(this,arguments)}}()),c.specialitys))})()}addSpeciality(c){var o=this;return(0,_.Z)(function*(){let p=!1;if((yield o.getAllSpecialities()).forEach(y=>{y.description==c.description&&(p=!0)}),!p){const y=o.firebaseStoreProvider.createDoc("specialities");return o.firebaseStoreProvider.saveDoc(y,JSON.parse(JSON.stringify(c)))}})()}getSpecialityPhoto(c){var o=this;return(0,_.Z)(function*(){try{const p=o.firebaseStorageProvider.referenceCloudStorage(c.image);return yield o.firebaseStorageProvider.getUrlFromFile(p)}catch{}})()}static#e=this.\u0275fac=function(o){return new(o||a)(v.LFG(O.f),v.LFG(A.O))};static#t=this.\u0275prov=v.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();const P=(0,u.ZF)(d.N.firebaseConfig),T=(0,l.ad)(P)}}]);