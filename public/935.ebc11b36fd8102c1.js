"use strict";(self.webpackChunkTPClinica=self.webpackChunkTPClinica||[]).push([[935,84],{8642:(y,g,i)=>{i.d(g,{u:()=>u});var _=i(5861),e=i(9468),c=i(5710),m=i(7615),d=i(6084),v=i(3251),E=i(6814),P=i(346);function A(r,p){if(1&r&&(e.TgZ(0,"div")(1,"h2",3),e._uU(2),e.qZA()()),2&r){const t=e.oxw();e.xp6(2),e.AsE("Historia Cl\xednica de ",t.selectedUser.lastName,", ",t.selectedUser.name,":")}}function O(r,p){if(1&r&&(e.TgZ(0,"option",10),e._uU(1),e.qZA()),2&r){const t=p.$implicit;e.s9C("value",t.userId),e.xp6(1),e.AsE("",t.lastName,", ",t.name,"")}}function T(r,p){if(1&r){const t=e.EpF();e.TgZ(0,"div")(1,"h2",3),e._uU(2,"Mi Historia Cl\xednica:"),e.qZA(),e.TgZ(3,"div",3)(4,"button",4),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.downloadMedicalRecord())}),e._uU(5,"Descargar "),e._UZ(6,"img",5),e.qZA()(),e.TgZ(7,"div",3)(8,"select",6)(9,"option",7),e._uU(10,"Seleccione una opcion..."),e.qZA(),e.TgZ(11,"option",8),e._uU(12,"TODOS"),e.qZA(),e.YNc(13,O,2,3,"option",9),e.qZA()()()}if(2&r){const t=e.oxw();e.xp6(13),e.Q6J("ngForOf",t.listOfUniqueSpecialist)}}function o(r,p){if(1&r&&(e.TgZ(0,"div",15)(1,"div",16)(2,"div",17),e._uU(3," Fecha y Hora: "),e.qZA(),e.TgZ(4,"div",18),e._uU(5),e.ALo(6,"hours"),e.ALo(7,"hours"),e.qZA(),e.TgZ(8,"div",19),e._uU(9," Especialista: "),e.qZA(),e.TgZ(10,"div"),e._UZ(11,"img",20),e._uU(12),e.qZA(),e.TgZ(13,"div",19),e._uU(14," Especialidad: "),e.qZA(),e.TgZ(15,"div"),e._UZ(16,"img",21),e._uU(17),e.qZA()(),e.TgZ(18,"div",16)(19,"div",17),e._uU(20," Rese\xf1a: "),e.qZA(),e.TgZ(21,"div",18)(22,"p",22),e._uU(23),e.qZA()(),e.TgZ(24,"div",19),e._uU(25," Diagnostico: "),e.qZA(),e.TgZ(26,"div",18)(27,"h5"),e._uU(28),e.qZA()()()()),2&r){const t=p.$implicit,l=p.index,s=e.oxw(3);e.xp6(5),e.lnq(" ",t.day.date," ",e.lcZ(6,11,t.day.timeStart)," - ",e.lcZ(7,13,t.day.timeEnd),"hs "),e.xp6(6),e.s9C("src",t.specialist.profilePhoto,e.LSH),e.xp6(1),e.AsE(" ",t.specialist.lastName,", ",t.specialist.name," "),e.xp6(4),e.s9C("src",s.getSpecialityPhoto(t.speciality),e.LSH),e.xp6(1),e.hij(" ",t.speciality," "),e.xp6(6),e.Oqu(t.review),e.xp6(4),e.uIk("id","item-"+l),e.xp6(1),e.Oqu(s.getDiagnosis(t,l))}}function h(r,p){if(1&r&&(e.TgZ(0,"div",13),e.YNc(1,o,29,15,"div",14),e.qZA()),2&r){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.myAppointments)}}function a(r,p){1&r&&(e.TgZ(0,"div")(1,"h3"),e._uU(2,"El paciente seleccionado aun no tiene Historial Clinico."),e.qZA()())}function n(r,p){if(1&r&&(e.TgZ(0,"div",11),e.YNc(1,h,2,1,"div",12),e.YNc(2,a,3,0,"div",1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.myAppointments.length>0),e.xp6(1),e.Q6J("ngIf",0==t.myAppointments.length)}}let u=(()=>{class r{constructor(t,l,s,f){this.aService=t,this.uService=l,this.sService=s,this.alertService=f,this.showTable=new e.vpe,this.myAppointments=[],this.listOfSpecialities=[],this.filteredAppointments=[],this.listOfUniqueSpecialist=[],this.listOfSpecialists=[],this.selectedSpecialistId="",this.setSpecialities(),this.aService.getAppointments()}ngOnChanges(){this.getMedicalRecord(this.selectedUser)}getMedicalRecord(t){null!=t&&(this.myAppointments=this.aService.appointments.filter(s=>s.patient.userId==t.userId&&"Realizado"==s.state),this.myAppointments=this.myAppointments.sort((s,f)=>f.day.date!==s.day.date?new Date(parseInt(s.day.date.substring(6)),parseInt(s.day.date.substring(3,5)),parseInt(s.day.date.substring(0,2)))>new Date(parseInt(f.day.date.substring(6)),parseInt(f.day.date.substring(3,5)),parseInt(f.day.date.substring(0,2)))?1:-1:parseFloat(s.day.timeStart)!=parseFloat(f.day.timeStart)?parseFloat(s.day.timeStart)>parseFloat(f.day.timeStart)?1:-1:0)),this.listOfSpecialists=[],this.listOfUniqueSpecialist=[],this.myAppointments.forEach(s=>{this.listOfSpecialists.includes(s.specialist.userId)||(this.listOfSpecialists.push(s.specialist.userId),this.listOfUniqueSpecialist.push(s.specialist))});const l=document.getElementById("specialist");l?.addEventListener("change",s=>{this.selectedSpecialistId=s.target.value})}return(){this.showTable.emit(!0)}setSpecialities(){var t=this;return(0,_.Z)(function*(){t.listOfSpecialities=yield t.sService.getAllSpecialities()})()}getSpecialityPhoto(t){let l;return this.listOfSpecialities?.forEach(s=>{s.description==t&&(l=s.image)}),l}getDiagnosis(t,l){let s=document.getElementById("item-"+l),f=t.diagnosis,S=`Altura: ${f.height} cm<br>Peso: ${f.weight} kg<br>Temperatura: ${f.temperature} C\xb0<br>Presion: ${f.pressure} mmHg`;f.dynamicData?.forEach(D=>{S+=`<br>${D.key}: ${D.value}`}),null!=s&&(s.innerHTML=S)}downloadMedicalRecord(){""!=this.selectedSpecialistId?"all"==this.selectedSpecialistId?this.uService.createPdf(this.myAppointments,this.uService.userLogged):(this.filteredAppointments=this.myAppointments.filter(t=>t.specialist.userId==this.selectedSpecialistId),this.uService.createPdf(this.filteredAppointments,this.uService.userLogged)):this.alertService.showAlert({icon:"error",message:"Debe seleccionar una opcion para descargar",timer:2e3})}static#e=this.\u0275fac=function(l){return new(l||r)(e.Y36(c.H),e.Y36(m.K),e.Y36(d.d),e.Y36(v.c))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-history"]],inputs:{selectedUser:"selectedUser"},outputs:{showTable:"showTable"},features:[e.TTD],decls:4,vars:3,consts:[[1,"d-flex","flex-column","justify-content-center","align-items-center","m-3","p-3"],[4,"ngIf"],["class","w-75 m-5 p-2 card bg-beige",4,"ngIf"],[1,"d-flex","justify-content-center","align-items-center","m-1","p-1"],[1,"btn","boton","m-2","p-2",3,"click"],["src","../../../assets/img/pdf.png","alt","pdf",2,"height","60px","width","60px"],["name","specialist","id","specialist",1,"form-select"],["value","","disabled","","selected",""],["value","all"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"w-75","m-5","p-2","card","bg-beige"],["class","d-flex flex-column",4,"ngIf"],[1,"d-flex","flex-column"],["class","card m-1 p-1",4,"ngFor","ngForOf"],[1,"card","m-1","p-1"],[1,"d-flex","flex-row","m-1","p-1"],[1,"titles"],[2,"padding-left","20px"],[1,"titles","padL"],["alt","foto_especialista",2,"height","100px","width","100px",3,"src"],["alt","foto_especialidad",2,"height","100px","width","100px",3,"src"],[1,"texto-limitado"]],template:function(l,s){1&l&&(e.TgZ(0,"div",0),e.YNc(1,A,3,2,"div",1),e.YNc(2,T,14,1,"div",1),e.YNc(3,n,3,2,"div",2),e.qZA()),2&l&&(e.xp6(1),e.Q6J("ngIf","admin"==(null==s.uService.userLogged?null:s.uService.userLogged.userRole)&&s.selectedUser),e.xp6(1),e.Q6J("ngIf","paciente"==(null==s.uService.userLogged?null:s.uService.userLogged.userRole)),e.xp6(1),e.Q6J("ngIf",null!=s.selectedUser))},dependencies:[E.sg,E.O5,P.X],styles:[".bg-beige[_ngcontent-%COMP%]{background-color:beige}.boton[_ngcontent-%COMP%]{border:2px solid black;background-color:#0ff}.boton[_ngcontent-%COMP%]:hover{background-color:#4e4ef1;color:#fff}.texto-limitado[_ngcontent-%COMP%]{overflow:visible;white-space:pre-wrap;text-overflow:clip;width:400px}.titles[_ngcontent-%COMP%]{font-weight:700;text-decoration:underline}.padL[_ngcontent-%COMP%]{padding-left:10%}"]})}return r})()},6710:(y,g,i)=>{i.d(g,{H:()=>m});var _=i(6814),e=i(103),c=i(9468);let m=(()=>{class d{static#e=this.\u0275fac=function(P){return new(P||d)};static#t=this.\u0275mod=c.oAB({type:d});static#i=this.\u0275inj=c.cJS({imports:[_.ez,e.D]})}return d})()},346:(y,g,i)=>{i.d(g,{X:()=>e});var _=i(9468);let e=(()=>{class c{transform(d,...v){return parseFloat(d)%1==0?`${d}:00`:`${Math.floor(d)}:30`}static#e=this.\u0275fac=function(v){return new(v||c)};static#t=this.\u0275pipe=_.Yjl({name:"hours",type:c,pure:!0})}return c})()},103:(y,g,i)=>{i.d(g,{D:()=>c});var _=i(6814),e=i(9468);let c=(()=>{class m{static#e=this.\u0275fac=function(E){return new(E||m)};static#t=this.\u0275mod=e.oAB({type:m});static#i=this.\u0275inj=e.cJS({imports:[_.ez]})}return m})()},5710:(y,g,i)=>{i.d(g,{H:()=>E});var _=i(5861),e=i(15),c=i(3182),m=i(9413),d=i(9468),v=i(3384);let E=(()=>{class O{constructor(o){this.firebaseStoreProvider=o,this.appointments=[]}getAllAppointments(){return this.firebaseStoreProvider.getCollection("turnos")}getAppointments(){var o=this;return(0,_.Z)(function*(){const h=(0,e.IO)((0,e.hJ)(A,"turnos"));(0,e.cf)(h,a=>(o.appointments=[],a.forEach(function(){var n=(0,_.Z)(function*(u){var r=u.data();o.appointments.push({...r})});return function(u){return n.apply(this,arguments)}}()),o.appointments))})()}saveAppointmentWithIdInStore(o,h){return this.firebaseStoreProvider.setDocWithId("turnos",o,JSON.parse(JSON.stringify(h)))}saveAppointmenInStore(o){const h=this.firebaseStoreProvider.createDoc("turnos");return o.id=h.id,this.firebaseStoreProvider.saveDoc(h,JSON.parse(JSON.stringify(o)))}static#e=this.\u0275fac=function(h){return new(h||O)(d.LFG(v.f))};static#t=this.\u0275prov=d.Yz7({token:O,factory:O.\u0275fac,providedIn:"root"})}return O})();const P=(0,c.ZF)(m.N.firebaseConfig),A=(0,e.ad)(P)},6084:(y,g,i)=>{i.d(g,{d:()=>A});var _=i(5861),e=i(4036),c=i(15),m=i(3182),d=i(9413),v=i(9468),E=i(3384),P=i(388);let A=(()=>{class o{constructor(a,n){this.firebaseStoreProvider=a,this.firebaseStorageProvider=n,this.specialitys=[]}getAllSpecialities(){var a=this;return(0,_.Z)(function*(){let n=yield(0,e.z)(a.firebaseStoreProvider.getCollection("specialities"));return n=yield Promise.all(n.map(function(){var u=(0,_.Z)(function*(r){return{...r,image:yield a.getSpecialityPhoto(r)}});return function(r){return u.apply(this,arguments)}}())),n})()}getSpecialities(){var a=this;return(0,_.Z)(function*(){const n=(0,c.IO)((0,c.hJ)(T,"specialities"));(0,c.cf)(n,u=>(a.specialitys=[],u.forEach(function(){var r=(0,_.Z)(function*(p){var t=p.data();a.specialitys.push({...t,image:yield a.getSpecialityPhoto(t)})});return function(p){return r.apply(this,arguments)}}()),a.specialitys))})()}addSpeciality(a){var n=this;return(0,_.Z)(function*(){let u=!1;if((yield n.getAllSpecialities()).forEach(p=>{p.description==a.description&&(u=!0)}),!u){const p=n.firebaseStoreProvider.createDoc("specialities");return n.firebaseStoreProvider.saveDoc(p,JSON.parse(JSON.stringify(a)))}})()}getSpecialityPhoto(a){var n=this;return(0,_.Z)(function*(){try{const u=n.firebaseStorageProvider.referenceCloudStorage(a.image);return yield n.firebaseStorageProvider.getUrlFromFile(u)}catch{}})()}static#e=this.\u0275fac=function(n){return new(n||o)(v.LFG(E.f),v.LFG(P.O))};static#t=this.\u0275prov=v.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();const O=(0,m.ZF)(d.N.firebaseConfig),T=(0,c.ad)(O)}}]);